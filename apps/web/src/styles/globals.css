@import "tailwindcss";
@config "../../tailwind.config.ts";

:root {
  /* ── Semantic colors (ocean-based, shadcn-compatible) ── */
  --background: 200 20% 97%;
  --foreground: 222 47% 11%;

  --card: 0 0% 100%;
  --card-foreground: 222 47% 11%;

  --popover: 0 0% 100%;
  --popover-foreground: 222 47% 11%;

  --primary: 193 68% 42%;
  --primary-foreground: 0 0% 100%;

  --secondary: 200 25% 95%;
  --secondary-foreground: 222 47% 11%;

  --muted: 200 20% 95%;
  --muted-foreground: 215 16% 47%;

  --accent: 200 25% 93%;
  --accent-foreground: 222 47% 11%;

  --destructive: 9 100% 54%;
  --destructive-foreground: 0 0% 100%;

  --success: 142 71% 45%;
  --success-foreground: 0 0% 100%;

  --warning: 38 92% 50%;
  --warning-foreground: 0 0% 100%;

  --border: 200 20% 89%;
  --input: 200 20% 85%;
  --ring: 193 68% 42%;

  --sidebar: 200 25% 95%;

  /* ── Radius ── */
  --radius: 0.5rem;

  /* ── Shadows ── */
  --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.04);
  --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.07), 0 1px 2px -1px rgb(0 0 0 / 0.07);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.08), 0 2px 4px -2px rgb(0 0 0 / 0.08);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

  /* ── Motion ── */
  --duration-fast: 150ms;
  --duration-normal: 200ms;
  --duration-slow: 300ms;
  --ease-default: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-spring: cubic-bezier(0.22, 1, 0.36, 1);

  /* ── Fonts (set by next/font in layout.tsx) ── */
  --font-sans: "Inter", ui-sans-serif, system-ui, -apple-system, sans-serif;
  --font-mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, monospace;
}

@layer base {
  html,
  body {
    height: 100%;
    max-width: 100vw;
    overflow-x: hidden;
    background: hsl(var(--background));
    color: hsl(var(--foreground));
  }

  body {
    font-family: var(--font-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-size: 14px;
    line-height: 1.5;
    font-feature-settings: "cv02", "cv03", "cv04", "cv11";
  }

  * {
    border-color: hsl(var(--border));
  }

  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: hsl(var(--background));
  }

  ::-webkit-scrollbar-thumb {
    background: hsl(var(--muted));
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--muted-foreground));
  }

  ::selection {
    background: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
  }

  :focus-visible {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 2px;
  }
}

/* ── Animations & Keyframes ── */

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes slide-in-from-top {
  from {
    transform: translateY(-4px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slide-in-from-bottom {
  from {
    transform: translateY(4px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slide-in-from-left {
  from {
    transform: translateX(-4px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slide-in-from-right {
  from {
    transform: translateX(4px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes scale-in {
  from {
    transform: scale(0.95);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes scale-out {
  from {
    transform: scale(1);
    opacity: 1;
  }
  to {
    transform: scale(0.95);
    opacity: 0;
  }
}

@keyframes accordion-down {
  from {
    height: 0;
    opacity: 0;
  }
  to {
    height: var(--radix-accordion-content-height);
    opacity: 1;
  }
}

@keyframes accordion-up {
  from {
    height: var(--radix-accordion-content-height);
    opacity: 1;
  }
  to {
    height: 0;
    opacity: 0;
  }
}

@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

@keyframes progress-pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

.animate-fade-in {
  animation: fade-in var(--duration-normal) var(--ease-default);
}

.animate-fade-out {
  animation: fade-out var(--duration-normal) var(--ease-default);
}

.animate-slide-in-from-top {
  animation: slide-in-from-top var(--duration-normal) var(--ease-spring);
}

.animate-slide-in-from-bottom {
  animation: slide-in-from-bottom var(--duration-normal) var(--ease-spring);
}

.animate-scale-in {
  animation: scale-in var(--duration-normal) var(--ease-spring);
}

.animate-accordion-down {
  animation: accordion-down var(--duration-slow) var(--ease-spring);
}

.animate-accordion-up {
  animation: accordion-up var(--duration-slow) var(--ease-spring);
}

.animate-shimmer {
  animation: shimmer 2s linear infinite;
  background: linear-gradient(
    90deg,
    hsl(var(--muted)) 25%,
    hsl(var(--secondary)) 50%,
    hsl(var(--muted)) 75%
  );
  background-size: 200% 100%;
}

/* ── Warning dash (strategy graph) ── */

@keyframes warning-dash {
  0% {
    background-position:
      0 0,
      100% 0,
      0 100%,
      0 0;
  }
  100% {
    background-position:
      24px 0,
      100% 24px,
      -24px 100%,
      0 -24px;
  }
}

.warning-dash {
  position: relative;
}

.warning-dash::before {
  content: "";
  position: absolute;
  inset: -3px;
  border-radius: inherit;
  pointer-events: none;
  background:
    repeating-linear-gradient(
        90deg,
        rgba(245, 158, 11, 0.9) 0 6px,
        rgba(245, 158, 11, 0) 6px 12px
      )
      0 0 / 100% 2px no-repeat,
    repeating-linear-gradient(
        180deg,
        rgba(245, 158, 11, 0.9) 0 6px,
        rgba(245, 158, 11, 0) 6px 12px
      )
      100% 0 / 2px 100% no-repeat,
    repeating-linear-gradient(
        90deg,
        rgba(245, 158, 11, 0.9) 0 6px,
        rgba(245, 158, 11, 0) 6px 12px
      )
      0 100% / 100% 2px no-repeat,
    repeating-linear-gradient(
        180deg,
        rgba(245, 158, 11, 0.9) 0 6px,
        rgba(245, 158, 11, 0) 6px 12px
      )
      0 0 / 2px 100% no-repeat;
  animation: warning-dash 2.5s linear infinite;
}

.warning-group-node {
  background: transparent;
  pointer-events: none;
}

/* ── Save attention pulse ── */

@keyframes save-attention {
  0%,
  100% {
    box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
    border-color: rgba(239, 68, 68, 0.35);
  }
  50% {
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.25);
    border-color: rgba(239, 68, 68, 0.6);
  }
}

.save-attention {
  animation: save-attention 2s ease-in-out infinite;
}

/* ── Toast ── */

@keyframes toast-in-out {
  0% {
    opacity: 0;
    transform: translateY(6px);
  }
  10% {
    opacity: 1;
    transform: translateY(0);
  }
  85% {
    opacity: 1;
    transform: translateY(0);
  }
  100% {
    opacity: 0;
    transform: translateY(-4px);
  }
}

.toast-animate {
  animation: toast-in-out var(--toast-duration, 3500ms) ease-in-out forwards;
}

@keyframes toast-progress {
  from {
    width: 100%;
  }
  to {
    width: 0%;
  }
}

.toast-progress {
  animation: toast-progress var(--toast-duration, 3500ms) linear forwards;
}

/* ── React Flow ── */

.react-flow__node {
  transition: transform var(--duration-normal) var(--ease-default);
}

.react-flow__edge-path {
  stroke: hsl(var(--primary));
  stroke-width: 2;
}

.react-flow__edge.selected .react-flow__edge-path {
  stroke: hsl(var(--accent));
  stroke-width: 3;
}

/* ── Markdown content ── */

.markdown-content h1 {
  @apply text-2xl font-bold mt-4 mb-2;
  color: hsl(var(--foreground));
}

.markdown-content h2 {
  @apply text-xl font-semibold mt-3 mb-2;
  color: hsl(var(--foreground));
}

.markdown-content a {
  color: hsl(var(--primary));
  @apply underline underline-offset-4;
  text-decoration-color: hsl(var(--primary) / 0.3);
}

.markdown-content a:hover {
  color: hsl(var(--primary) / 0.8);
  text-decoration-color: hsl(var(--primary) / 0.6);
}

.markdown-content p {
  @apply mb-3 leading-relaxed;
}

.chat-messages .markdown-content p {
  margin-bottom: 0.25rem;
}

.chat-messages .markdown-content p:last-child {
  margin-bottom: 0;
}

.markdown-content code {
  @apply px-1.5 py-0.5 rounded text-sm font-mono;
  background: hsl(var(--muted));
  color: hsl(var(--foreground));
}

.markdown-content pre {
  @apply p-4 rounded-lg overflow-x-auto mb-4;
  background: hsl(var(--muted));
}

.markdown-content ul {
  @apply list-disc list-outside mb-3 space-y-1 pl-5;
}

.markdown-content ol {
  @apply list-decimal list-outside mb-3 space-y-1 pl-5;
}

.markdown-content ul ul,
.markdown-content ul ol,
.markdown-content ol ul,
.markdown-content ol ol {
  @apply mt-1 mb-0 pl-5;
}

.markdown-content ul {
  list-style-type: disc;
}
.markdown-content ul ul {
  list-style-type: circle;
}
.markdown-content ul ul ul {
  list-style-type: square;
}

.markdown-content ol {
  list-style-type: decimal;
}
.markdown-content ol ol {
  list-style-type: lower-alpha;
}
.markdown-content ol ol ol {
  list-style-type: lower-roman;
}
